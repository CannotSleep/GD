require("../../../common/manifest.js");
require("../../../common/vendor.js");
global.webpackJsonp([29],{35:function(t,e,a){"use strict";var s=n(a(1)),i=n(a(36));function n(t){return t&&t.__esModule?t:{default:t}}new s.default(i.default).$mount()},36:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a(38),i=a.n(s),n=a(42),o=!1;var c=function(t){o||a(37)},r=a(0)(i.a,n.a,c,"data-v-4767e4ba",null);r.options.__file="F:\\施工管理平台\\20181101\\XC.qsp.app\\pages\\index\\quality\\safetyList.vue",r.esModule&&Object.keys(r.esModule).some(function(t){return"default"!==t&&"__"!==t.substr(0,2)})&&console.error("named exports are not supported in *.vue files."),r.options.functional&&console.error("[vue-loader] safetyList.vue: functional components are not supported with templates, they should use render functions."),e.default=r.exports},37:function(t,e){},38:function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var s=n(a(3)),i=n(a(5));function n(t){return t&&t.__esModule?t:{default:t}}e.default={onLoad:function(e){var a=e.state;switch(this.needautograph=e.infoType+"",this.Token=s.default.net.GetSessionToken(),a){case"0":t.setNavigationBarTitle({title:"安全检查记录"}),this.searchType=0;break;case"my":t.setNavigationBarTitle({title:"我的安全检查"}),this.searchType=2;break;case"1":t.setNavigationBarTitle({title:"安全整改记录"}),this.searchType=1;break;case"3":t.setNavigationBarTitle({title:"消息记录"}),this.searchType=3}"undefined"!=this.needautograph?(this.searchType=0,this.searchData()):this.getCompany()},onShow:function(){0!=this.isfirstopen&&this.searchData()},onReachBottom:function(){0===this.loadingType&&(this.page=this.page+1,console.log(this.page),this.loadingType=1,this.searchData())},data:function(){return{Token:"",companyList:[],companyIndex:0,projectList:[],companyText:"",projectText:"",projectIndex:0,companyVal:"",projectVal:"",safetyList:[],searchType:"",needautograph:"",isfirstopen:0,page:1,size:10,loadingType:0,contentText:{contentdown:"上拉显示更多",contentrefresh:"正在加载...",contentnomore:"没有更多数据了"}}},methods:{getCompany:function(){var e=this,a=s.default.net.setUrl("api/DropDownListApi/GetCompany");t.request({url:a,dataType:"json",type:"GET",header:{Token:this.Token},success:function(a){s.default.net.showWrongTipsEx(a);var i=a.data,n=i.data;if(1==i.status){console.log("公司获取成功");n.unshift({value:"",text:"请选择公司"}),e.companyList=e.setData(i.data),e.companyVal=e.companyList[e.companyIndex].value,e.companyText=e.companyList[e.companyIndex].text,""!=e.companyVal&&e.getProject()}else console.log(i.status),t.showToast({title:i.status,mask:!1,duration:1500})},fail:function(t,e){console.log("公司获取失败"+t+e)}})},getProject:function(){var e=this,a=s.default.net.setUrl("api/DropDownListApi/GetProject");t.request({url:a,method:"GET",header:{Token:this.Token},data:{company:this.companyVal},success:function(t){s.default.net.showWrongTipsEx(t);var a=t.data,i=a.data;1==a.status?(e.projectList=e.setData(i),e.projectVal=e.projectList[e.projectIndex].value,e.projectText=e.projectList[e.projectIndex].text):console.log("项目获取失败"+a.status)},fail:function(t,e){console.log("项目数据请求失败"+t+e)},complete:function(){}})},setData:function(t){var e=[];return t.forEach(function(t){e.push({text:t.text,value:t.value})}),e},changeCompany:function(t){this.companyIndex=t.detail.value,this.companyVal=this.companyList[t.detail.value].value,this.companyText=this.companyList[this.companyIndex].text,this.projectIndex=0,this.getProject()},changeProject:function(t){this.projectIndex=t.detail.value,this.projectVal=this.projectList[t.detail.value].value,this.projectText=this.projectList[this.projectIndex].text},searchBtn:function(){this.page=1,this.searchData()},searchData:function(){var e=this;console.log(this.searchType);var a={way:0},i=s.default.net.setUrl("api/SecurityInspectApi/GetList?operate="+this.searchType+"&page="+this.page);"undefined"!=this.needautograph&&(i+="&settingtype="+this.needautograph),""!=this.projectVal&&(a={Company:this.companyVal,ProjectId:this.projectVal}),t.request({url:i,method:"POST",header:{Token:this.Token},data:JSON.stringify(a),success:function(a){s.default.net.showWrongTipsEx(a);var i=a.data,n=i.data;if(console.log(a),1==i.status){var o=[];if(""==n)return t.showToast({title:"暂无数据"}),void(e.loadingType=2);if(n.forEach(function(t){o.push({Title:t.Title,CrashLevelName:t.CrashLevelName,ID:t.ID,ExpireDate:t.ExpireDate.substring(0,10),StateName:t.StateName,State:t.State,CrashLevel:t.CrashLevel})}),o.length<1)return void(e.loadingType=2);1==e.page&&(e.safetyList=[]),console.log(o),e.safetyList=e.safetyList.concat(o),e.loadingType=0}else console.log(i.message),t.showToast({title:"暂无数据",mask:!1,duration:1500})},fail:function(){},complete:function(){}})},goDetail:function(e){this.isfirstopen+=1;e.ID;t.navigateTo({url:"SafetyDetails?id="+e.ID})}},components:{loadMore:i.default}}}).call(e,a(2).default)},42:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("view",{staticClass:"content"},[a("view",{staticClass:"input-row"},[t._m(0),a("picker",{attrs:{value:t.companyIndex,range:t.companyList,"range-key":"text",eventid:"1WI-0"},on:{change:t.changeCompany}},[a("view",{staticClass:"uni-input"},[t._v(t._s(t.companyText))])])],1),a("view",{staticClass:"input-row"},[t._m(1),a("picker",{attrs:{value:t.projectIndex,range:t.projectList,"range-key":"text",eventid:"q8R-1"},on:{change:t.changeProject}},[a("view",{staticClass:"uni-input"},[t._v(t._s(t.projectText))])])],1),a("view",{staticClass:"input-row"},[a("button",{staticClass:"search-btn",attrs:{type:"",size:"mini",eventid:"AYo-2"},on:{tap:t.searchBtn}},[t._v("查询")])],1),0!=t.safetyList.length?a("view",{staticClass:"list-content"},[a("view",{staticClass:"uni-list"},[t._l(t.safetyList,function(e,s){return a("block",{key:s},[a("view",{staticClass:"uni-list-cell",attrs:{"hover-class":"uni-list-cell-hover",eventid:"clW-3-"+s},on:{tap:function(a){t.goDetail(e)}}},[a("view",{staticClass:"uni-triplex-row"},[a("view",{staticClass:"uni-triplex-left"},[a("text",{staticClass:"list-title uni-ellipsis"},[t._v(t._s(e.Title))]),a("label",[a("text",{staticClass:"list-deadline"},[t._v("整改期限至："+t._s(e.ExpireDate))]),a("text",{staticClass:"list-level",class:{crash0:0==e.CrashLevel,crash1:1==e.CrashLevel,crash2:2==e.CrashLevel}},[t._v(t._s(e.CrashLevelName))]),a("text",{staticClass:"list-state",class:{state0:0==e.State,state1:1==e.State,state2:2==e.State,state3:3==e.State,state4:4==e.State}},[t._v(t._s(e.StateName))])])],1)])])])}),a("load-more",{attrs:{loadingType:t.loadingType,contentText:t.contentText,mpcomid:"nhe-0"}})],2)]):t._e()])};s._withStripped=!0;var i={render:s,staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("view",{staticClass:"input-label"},[e("image",{attrs:{src:"../../../static/img/list1_icon/list1_icon-01.png",mode:""}}),e("text",[this._v("所属公司:")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("view",{staticClass:"input-label"},[e("image",{attrs:{src:"../../../static/img/list1_icon/list1_icon-02.png",mode:""}}),e("text",[this._v("项目名称:")])])}]};e.a=i}},[35]);
//# sourceMappingURL=../../../../.sourcemap/mp-weixin/pages/index/quality/safetyList.js.map