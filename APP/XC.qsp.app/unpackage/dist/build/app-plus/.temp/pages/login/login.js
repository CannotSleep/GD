require("../../common/manifest.js");
require("../../common/vendor.js");
global.webpackJsonp([6],{17:function(t,e,o){"use strict";var n=a(o(1)),s=a(o(18));function a(t){return t&&t.__esModule?t:{default:t}}new n.default(s.default).$mount()},18:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o(20),s=o.n(n),a=o(21);var i=function(t){o(19)},l=o(0)(s.a,a.a,i,"data-v-7f08a396",null);e.default=l.exports},19:function(t,e){},20:function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var n,s=o(3),a=(n=s)&&n.__esModule?n:{default:n};e.default={data:function(){return{src:"../../static/img/logo.png",account:"",password:"",loading:!1,isAuto:!1,index:0}},methods:{login:function(){var e=this;if(this.loading=!0,this.account.length<1)t.showToast({icon:"none",title:"用户名不能为空",success:function(t){e.loading=!1}});else if(this.password.length<1)t.showToast({icon:"none",title:"密码不能为空",success:function(t){e.loading=!1}});else{var o=JSON.stringify({AccountID:this.account,Password:this.password}),n=a.default.net.setUrl("api/loginapi/login");console.log("请求地址："+n),t.request({url:n,data:o,dataType:"json",method:"POST",header:{"content-type":"application/json"},success:function(o,n){var s=o.data;1==s.status?(t.showToast({icon:"none",title:"登录成功"}),a.default.net.SetSessionToken(s.token),e.getAuthorityMenus(),console.log(e.isAuto),1==e.isAuto&&a.default.net.SetLocalToken(s.token),t.switchTab({url:"../index/index",fail:function(t){console.log("跳转失败")}}),a.default.net.SetUser(s.data),console.log("本次登录token："+a.default.net.GetSessionToken())):(console.log(s.message),t.showToast({icon:"none",title:s.message,success:function(t){e.loading=!1}}))},fail:function(){console.log("登录失败")},complete:function(){e.loading=!1}})}},autoLogin:function(t){console.log(t.detail.value),this.isAuto=t.detail.value},getAuthorityMenus:function(){var e=a.default.net.setUrl("api/loginapi/GetAuthority");t.request({url:e,method:"POST",header:{Token:a.default.net.GetSessionToken()},success:function(t){var e=t.data,o=e.data;if(e.status=1){var n="";console.log("菜单权限获取成功");for(var s=0;s<o.length;s++)n+=o[s].Name+",",""!=o[s].AppTitle&&(n+=o[s].AppTitle+",");a.default.net.SetMenus(n)}else console.log("菜单权限获取失败"),a.default.net.SetMenus("")},fail:function(t,e){console.log("菜单权限获取失败:"+t+e),a.default.net.SetMenus("")},complete:function(){}})}}}}).call(e,o(2).default)},21:function(t,e,o){"use strict";var n={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("view",{staticClass:"content"},[o("view",{staticClass:"img-group mt-20"},[o("image",{attrs:{src:t.src}})]),o("view",{staticClass:"input-group mt-20"},[o("view",{staticClass:"login-input-row mt-20"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.account,expression:"account"}],attrs:{type:"text",value:"",placeholder:"请输入用户名","placeholder-style":"color:#fff",eventid:"59d-0"},domProps:{value:t.account},on:{input:function(e){e.target.composing||(t.account=e.target.value)}}})]),o("view",{staticClass:"login-input-row mt-20"},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],attrs:{type:"password",value:"",placeholder:"请输入密码","placeholder-style":"color:#fff",eventid:"lkE-1"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})]),o("view",{staticClass:"login-input-row mt-20 "},[o("view",{staticClass:"uni-list-cell uni-list-cell-pd"},[o("view",{staticClass:"uni-list-cell-db"},[t._v("自动登录")]),o("switch",{attrs:{color:"#0ce998",eventid:"d8J-2"},on:{change:t.autoLogin}})])]),o("view",{staticClass:"btn-row"},[o("button",{attrs:{type:"primary",loading:t.loading,eventid:"0lM-3"},on:{tap:t.login}},[t._v("登录")])],1)])])},staticRenderFns:[]};e.a=n}},[17]);