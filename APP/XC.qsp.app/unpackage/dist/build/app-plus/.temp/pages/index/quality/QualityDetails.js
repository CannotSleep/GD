require("../../../common/manifest.js");
require("../../../common/vendor.js");
global.webpackJsonp([39],{54:function(t,e,i){"use strict";var a=n(i(1)),s=n(i(55));function n(t){return t&&t.__esModule?t:{default:t}}new a.default(s.default).$mount()},55:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i(57),s=i.n(a),n=i(58);var l=function(t){i(56)},c=i(0)(s.a,n.a,l,"data-v-21db680d",null);e.default=c.exports},56:function(t,e){},57:function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var a,s=i(3),n=(a=s)&&a.__esModule?a:{default:a};e.default={data:function(){return{pageId:"",Token:"",SubcontractingUnit:"",Title:"",Number:"",RectPeople:"",Company:"",Building:"",Floor:"",SafetyDanger:"",DangerDes:"",ExpirDate:"",CrashLevel:"",CheckDate:"",ReCheckDate:"",State:"",Rectification:"",AddPeople:"",Project:"",isReply:!1,isApproval:!1,isRejected:!1,isRecheck:!1,isFinished:!1,replyContent:"",rejuectContent:"",imageList:[],repleyList:[]}},onLoad:function(t){this.pageId=t.id,this.Token=n.default.net.GetSessionToken(),this.getDetails(t.id),this.GetImage(),this.GetReply()},methods:{getDetails:function(e){var i=this,a=n.default.net.setUrl("api/QualityApi/GetDetail"),s={qid:e};t.request({url:a,method:"POST",dataType:"json",header:{Token:this.Token,"content-type":"application/json"},data:JSON.stringify(s),success:function(e){var a=e.data,s=a.data;if(1==a.status)switch(i.Number=s.Number,i.Company=s.BranchCompanyName,i.Project=s.ProjectName,i.Title=s.Title,i.Floor=s.Floor,i.Building=s.Building,i.SubcontractingUnit=s.AdditionalUnitName,i.SafetyDanger=s.DangerDes,i.DangerDes=s.QualityDanger,i.RectPeople=s.RectPeopleName,i.Rectification=s.Rectification,i.AddPeople=s.CheckPeopleName,i.ExpirDate=s.ExpireDate,i.CheckDate=s.Checkdate.substring(0,10),i.ReCheckDate=s.ReCheckdate.substring(0,10),i.CrashLevel=s.CrashLevelName,i.State=s.StateName,console.log(s.State),s.State){case 0:i.isApproval=!0,i.isRejected=!0;break;case 1:i.isReply=!0;break;case 2:console.log(i.isRejected),i.JudgeAc()}else console.log(a.message),t.showToast({title:a.message})},fail:function(e){console.log(e),t.showToast({title:"数据获取失败，请检查您的网络环境"})}})},JudgeAc:function(){var e=this,i=n.default.net.setUrl("api/QualityApi/JudgeAc?proid="+this.pageId);t.request({url:i,method:"POST",header:{token:this.Token},success:function(t){"9"==t.data&&(e.isRecheck=!0,e.isFinished=!0)},fail:function(){},complete:function(){}})},Complete:function(){var e=n.default.net.setUrl("api/QualityApi/Complete"),i={id:this.pageId};t.request({url:e,method:"POST",data:JSON.stringify(i),header:{token:this.Token},success:function(e){var i=e.data;t.showToast({title:i.message}),setTimeout(function(){t.navigateBack({delta:1})},2e3)},fail:function(){},complete:function(){}})},Reply:function(e){var i=0;switch(e){case 1:i=1;break;case 2:i=2}t.navigateTo({url:"Repley?Type=2&SubType="+i+"&id="+this.pageId})},Review:function(e){console.log(e);var i=n.default.net.setUrl("api/QualityApi/Pass"),a={id:this.pageId};t.request({url:i,method:"POST",data:JSON.stringify(a),header:{token:this.Token},success:function(e){var i=e.data;t.showToast({title:i.message}),setTimeout(function(){t.navigateBack({delta:1})},2e3)},fail:function(){},complete:function(){}})},Reject:function(e){console.log(e);var i=n.default.net.setUrl("api/QualityApi/Refuse"+this.pageId),a={id:this.pageId,reason:this.replyContent};t.request({url:i,method:"POST",data:JSON.stringify(a),header:{token:this.Token},success:function(e){var i=e.data;console.log(e),t.showToast({title:i.message}),setTimeout(function(){t.navigateBack({delta:1})},2e3)},fail:function(){},complete:function(){}})},previewImage:function(e){var i=e.target.dataset.src;t.previewImage({current:i,urls:this.imageList})},GetImage:function(e){var i=this;console.log(this.pageId);var a=n.default.net.setUrl("api/FileApi/GetFileTable?foreignId="+this.pageId+"&type=2");t.request({url:a,method:"POST",header:{token:this.Token},success:function(t){var e=t.data.data,a=[],s=!0,l=!1,c=void 0;try{for(var r,o=e[Symbol.iterator]();!(s=(r=o.next()).done);s=!0){var u=r.value,v=n.default.net.setUrl(u.FileSrc);a.push(v)}}catch(t){l=!0,c=t}finally{try{!s&&o.return&&o.return()}finally{if(l)throw c}}i.imageList=a},fail:function(){},complete:function(){}})},GetReply:function(e){var i=this;console.log(this.pageId);var a=n.default.net.setUrl("api/QualityApi/GetRepleyList"),s={qualityid:this.pageId};t.request({url:a,method:"POST",header:{token:this.Token},data:JSON.stringify(s),success:function(t){console.log(t);var e=t.data.data,a=!0,s=!1,l=void 0;try{for(var c,r=e[Symbol.iterator]();!(a=(c=r.next()).done);a=!0){var o=c.value,u=!0,v=!1,d=void 0;try{for(var p,_=o.FileImage[Symbol.iterator]();!(u=(p=_.next()).done);u=!0){var f=p.value;f.FileSrc=n.default.net.setUrl(f.FileSrc)}}catch(t){v=!0,d=t}finally{try{!u&&_.return&&_.return()}finally{if(v)throw d}}}}catch(t){s=!0,l=t}finally{try{!a&&r.return&&r.return()}finally{if(s)throw l}}i.repleyList=e},fail:function(){},complete:function(){}})}}}}).call(e,i(2).default)},58:function(t,e,i){"use strict";var a={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("view",{staticClass:"content"},[i("view",{staticClass:"input-row"},[t._m(0),i("view",{staticClass:"detail-box"},[t._v("\n\t\t\t\t"+t._s(Number)+"\n\t\t\t")])]),i("view",{staticClass:"input-row"},[t._m(1),i("view",{staticClass:"detail-box"},[t._v("\n\t\t\t\t"+t._s(t.Company)+"\n\t\t\t")])]),i("view",{staticClass:"input-row"},[t._m(2),i("view",{staticClass:"detail-box"},[t._v("\n\t\t\t\t"+t._s(t.Project)+"\n\t\t\t")])]),i("view",{staticClass:"input-row"},[t._m(3),i("view",{staticClass:"detail-box"},[t._v("\n\t\t\t\t"+t._s(t.Title)+"\n\t\t\t")])]),i("view",{staticClass:"input-row"},[t._m(4),i("view",{staticClass:"detail-box"},[t._v("\n\t\t\t\t"+t._s(t.Floor)+"\n\t\t\t")])]),i("view",{staticClass:"input-row"},[t._m(5),i("view",{staticClass:"detail-box"},[t._v("\n\t\t\t\t"+t._s(t.Building)+"\n\t\t\t")])]),i("view",{staticClass:"input-row"},[t._m(6),i("view",{staticClass:"detail-box"},[t._v("\n\t\t\t\t"+t._s(t.SubcontractingUnit)+"\n\t\t\t")])]),i("view",{staticClass:"input-row"},[t._m(7),i("view",{staticClass:"detail-box"},[t._v("\n\t\t\t\t"+t._s(t.SafetyDanger)+"\n\t\t\t")])]),i("view",{staticClass:"input-row"},[t._m(8),i("view",{staticClass:"detail-box"},[t._v("\n\t\t\t\t"+t._s(t.DangerDes)+"\n\t\t\t")])]),i("view",{staticClass:"input-row"},[t._m(9),i("view",{staticClass:"detail-box"},[t._v("\n\t\t\t\t"+t._s(t.Rectification)+"\n\t\t\t")])]),i("view",{staticClass:"input-row"},[t._m(10),i("view",{staticClass:"detail-box "},[t._v("\n\t\t\t\t"+t._s(t.RectPeople)+"\n\t\t\t")])]),i("view",{staticClass:"input-row"},[t._m(11),i("view",{staticClass:"detail-box "},[t._v("\n\t\t\t\t"+t._s(t.ExpirDate)+"\n\t\t\t")])]),i("view",{staticClass:"input-row"},[t._m(12),i("view",{staticClass:"detail-box "},[t._v("\n\t\t\t\t"+t._s(t.CheckDate)+"\n\t\t\t")])]),i("view",{staticClass:"input-row"},[t._m(13),i("view",{staticClass:"detail-box "},[t._v("\n\t\t\t\t"+t._s(t.ReCheckDate)+"\n\t\t\t")])]),i("view",{staticClass:"input-row"},[t._m(14),i("view",{staticClass:"detail-box "},[t._v("\n\t\t\t\t"+t._s(t.CrashLevel)+"\n\t\t\t")])]),i("view",{staticClass:"input-row"},[t._m(15),i("view",{staticClass:"detail-box "},[t._v("\n\t\t\t\t"+t._s(t.AddPeople)+"\n\t\t\t")])]),i("view",{staticClass:"input-row"},[t._m(16),i("view",{staticClass:"detail-box "},[t._v("\n\t\t\t\t"+t._s(t.State)+"\n\t\t\t")])]),i("view",[i("view",{staticClass:"uni-list-cell cell-pd"},[i("view",{staticClass:"uni-uploader"},[t._m(17),i("view",{staticClass:"uni-uploader-body"},[i("view",{staticClass:"uni-uploader__files"},t._l(t.imageList,function(e,a){return i("block",{key:a},[i("view",{staticClass:"uni-uploader__file"},[i("image",{staticClass:"uni-uploader__img",attrs:{src:e,"data-src":e,eventid:"A7X-0-"+a},on:{tap:t.previewImage}})])])}))])])])]),t.isRejected?i("view",{staticClass:"input-row"},[t._m(18),i("label",{staticClass:"myim"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.replyContent,expression:"replyContent"}],attrs:{type:"text",value:"",placeholder:"请填写拒绝理由",eventid:"Q2p-1"},domProps:{value:t.replyContent},on:{input:function(e){e.target.composing||(t.replyContent=e.target.value)}}})])],1):t._e(),i("view",{staticClass:"grace-comment"},t._l(t.repleyList,function(e,a){return i("block",{key:a},[i("view",{staticClass:"grace-comment-list"},[i("view",{staticClass:"grace-comment-face"},[i("image",{attrs:{src:"https://img-cdn-qiniu.dcloud.net.cn/uniapp/images/uni@2x.png",mode:"widthFix"}})]),i("view",{staticClass:"grace-comment-body"},[i("view",{staticClass:"grace-comment-top"},[i("text",[t._v(t._s(0==e.Type?"回复":"复查"))]),i("text",{staticClass:"grace-iconfont icon-zan"})]),i("view",{staticClass:"grace-comment-date"},[i("text",[t._v(t._s(e.ReplyTime))])]),i("view",{staticClass:"grace-comment-content"},[t._v(t._s(e.ReplyContent))]),i("view",{staticClass:"uni-uploader-body"},[i("view",{staticClass:"uni-uploader__files"},t._l(e.FileImage,function(e,s){return i("block",{key:s},[i("view",{staticClass:"uni-uploader__file"},[i("image",{staticClass:"uni-uploader__img",attrs:{src:e.FileSrc,"data-src":e.FileSrc,eventid:"syA-2-"+a+"-"+s},on:{tap:t.previewImage}})])])}))])])])])})),i("view",{staticClass:"button-row"},[t.isReply?i("button",{staticClass:"search-btn",attrs:{size:"mini",eventid:"yKz-3"},on:{tap:function(e){t.Reply(1)}}},[t._v("回复")]):t._e(),t.isApproval?i("button",{staticClass:"danger-btn",attrs:{size:"mini",eventid:"56U-4"},on:{tap:function(e){t.Reject(4)}}},[t._v("审批拒绝")]):t._e(),t.isRejected?i("button",{staticClass:"search-btn",attrs:{size:"mini",eventid:"Ekq-5"},on:{tap:function(e){t.Review(3)}}},[t._v("审批通过")]):t._e(),t.isRecheck?i("button",{staticClass:"search-btn",attrs:{size:"mini",eventid:"GFZ-6"},on:{tap:function(e){t.Reply(2)}}},[t._v("复查")]):t._e(),t.isFinished?i("button",{staticClass:"search-btn",attrs:{size:"mini",eventid:"6dC-7"},on:{tap:function(e){t.Complete()}}},[t._v("合格完成")]):t._e()],1)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("view",{staticClass:"input-label"},[e("text",[this._v("编号:")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("view",{staticClass:"input-label"},[e("text",[this._v("分公司:")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("view",{staticClass:"input-label"},[e("text",[this._v("工程项目:")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("view",{staticClass:"input-label"},[e("text",[this._v("标题:")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("view",{staticClass:"input-label"},[e("text",[this._v("栋号:")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("view",{staticClass:"input-label"},[e("text",[this._v("楼号:")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("view",{staticClass:"input-label"},[e("text",[this._v("分包单位:")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("view",{staticClass:"input-label"},[e("text",[this._v("隐患类型:")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("view",{staticClass:"input-label"},[e("text",[this._v("隐患描述:")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("view",{staticClass:"input-label"},[e("text",[this._v("整改要求:")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("view",{staticClass:"input-label"},[e("text",[this._v("整改人:")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("view",{staticClass:"input-label"},[e("text",[this._v("整改日期:")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("view",{staticClass:"input-label"},[e("text",[this._v("检查日期:")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("view",{staticClass:"input-label"},[e("text",[this._v("复查日期:")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("view",{staticClass:"input-label"},[e("text",[this._v("紧急级别:")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("view",{staticClass:"input-label"},[e("text",[this._v("填写人:")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("view",{staticClass:"input-label"},[e("text",[this._v("状态:")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("view",{staticClass:"uni-uploader-head"},[e("view",{staticClass:"uni-uploader-title"},[this._v("图片:")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("view",{staticClass:"input-label"},[e("text",[this._v("拒绝理由:")])])}]};e.a=a}},[54]);